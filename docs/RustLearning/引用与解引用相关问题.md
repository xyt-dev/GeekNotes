---
title: 引用与解引用相关问题
order: 6
---

# 引用与解引用相关问题

## `[]`下标访问行为

```rust:no-line-numbers
let arr = vec![String::new(), String::new()];
arr[0]; // move occurs because value has type `String`, which does not implement the `Copy` trait
```

```rust:no-line-numbers
let arr = vec![String::new(), String::new()];
&arr[0]; // ok
```

对该现象的理解: \
`arr[0];`相当于`*(arr.index(0));`. **其中`arr.index(0)`返回&String, 而下标访问的语义是访问其中的值, 因此会再进行解引用.** \
但`arr[0];`没有移动所有权给其他变量啊? 应该是**此处`arr[0]`成为了一个临时变量, 相当于移动数据的所有权给该临时变量, 而编译器不允许通过引用移动其中数据所有权.** \
那么凭什么`&arr[0];`就可以编译通过? deepseek: 对于`&(*(arr.index(0)))`Rust编译器会进行**优化, 令`&`和`*`相互抵消, 从而将其简化为`arr.index(0)`**, 即直接返回 `&String`.